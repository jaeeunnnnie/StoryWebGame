<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>내 친구의 사생활</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app">

    <!--  입장 화면 (JS: screen-name) -->
    <section id="screen-name" class="screen">
      <div class="entry-container">
        <h1 class="entry-title">내 친구의 사생활</h1>

        <div class="entry-content">
          <!-- 왼쪽: 아바타 선택 -->
          <div class="entry-left">
            <div class="avatar-preview-container">
              <p class="subtitle">선택한 아바타</p>
              <div id="avatar-preview" class="avatar-preview"></div>
            </div>
            <div class="avatar-selection">
              <p class="subtitle">아바타 선택</p>
              <div id="avatar-list" class="avatar-list"></div>
            </div>
          </div>

          <!-- 오른쪽: 닉네임 및 버튼 -->
          <div class="entry-right">
            <div class="nickname-section">
              <p class="subtitle">닉네임</p>
              <input id="input-nickname" placeholder="닉네임 입력" maxlength="10">
            </div>
            <div class="entry-buttons">
              <button id="btn-create-room">방 만들기</button>
              <button id="btn-join-room">방 들어가기</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--  방 코드 입력 (JS: screen-waiting) -->
    <section id="screen-waiting" class="screen hidden">
      <div class="card">
        <h2>방 코드 입력</h2>
        <input id="input-room-code" placeholder="예: 12345" />
        <button id="btn-join">Go!</button>
      </div>
    </section>

    <!--  로비 -->
    <section id="screen-lobby" class="screen hidden">
      <div class="card wide">
        <h2>
          대기실
          <span id="display-room-code"></span>
        </h2>

        <div id="player-list" class="player-grid"></div>

        <!-- 나가기 버튼: JS의 btnLeave 매칭 -->
        <button id="btn-leave" style="margin-top:10px;">나가기</button>

        <!-- 게스트에서 깜빡임 방지: 기본 hidden -->
        <div id="host-controls" class="hidden" style="margin-top:10px;">
          <button id="btn-copy">코드 복사</button>
          <button id="btn-start">게임 시작</button>
        </div>

        <p id="wait-msg-lobby" class="hidden">
          방장이 게임을 시작하기를 기다리는 중…
        </p>
      </div>
    </section>

    <!-- 카운트다운 화면 -->
    <section id="screen-countdown" class="screen hidden">
      <div class="card" style="text-align:center;">
        <h2 style="margin-bottom:12px;">곧 시작합니다</h2>
        <div id="countdown-number" style="font-size:72px; font-weight:800;">3</div>
      </div>
    </section>



    <!--  카드 입력 -->
    <section id="screen-prompts" class="screen hidden">
      <h2 style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">3개의 카드를 만들어주세요</h2>
      <p class="subtitle" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">당신의 카드가 스토리가 됩니다!</p>

      <div class="prompt-container">
        <div class="note-background">
          <div class="keyword-cards-wrapper">
            <div class="keyword-card">
              <img src="/image/card1.png" alt="카드1">
              <input type="text" class="input-prompt" placeholder="코딩하는 기훈이">
            </div>
            <div class="keyword-card">
              <img src="/image/card2.png" alt="카드2">
              <input type="text" class="input-prompt" placeholder="비밀의 방">
            </div>
            <div class="keyword-card">
              <img src="/image/card3.png" alt="카드3">
              <input type="text" class="input-prompt" placeholder="마법의 주문">
            </div>
          </div>
        </div>
      </div>

      <button id="btn-submit-prompts" style="width: auto; padding: 15px 50px;">작성 완료</button>
      <p id="wait-msg" class="hidden">다른 플레이어들을 기다리는 중...</p>
    </section>

    <!--  스토리 이어쓰기 -->
    <section id="screen-story" class="screen hidden">
      <div class="story-layout">
        <!-- 왼쪽 플레이어 사이드바 -->
        <div id="players-left" class="player-sidebar player-sidebar-left"></div>

        <!-- 중앙 게임 영역 -->
        <div class="story-main">
          <div class="card wide">
            <div style="display: flex; justify-content: space-between; align-items: center;">
             
              <h2 id="round-label">
                라운드 <span id="display-round">0</span> / <span id="display-total-rounds">0</span>
              </h2>

              <div id="display-timer" style="font-size: 24px; font-weight: bold; color: #ff6b6b;">20s</div>
            </div>

            <div style="margin-top: 10px;">
              <p class="subtitle">이번 라운드 제시어</p>
              <div id="my-inbox-prompts" class="result-grid"></div>
            </div>

            <div style="margin-top: 10px;">
              <p class="subtitle">지금까지의 이야기</p>
              <div id="story-so-far" class="card" style="width: 100%; text-align:left;"></div>
            </div>

            <div style="margin-top: 10px;">
              <p class="subtitle">이어쓰기</p>
              <textarea
                id="input-story-text"
                rows="4"
                style="width:100%; padding:12px; border-radius:8px; border:2px solid #475569; background:#1e293b; color:white; box-sizing:border-box;"
                placeholder="여기에 문장을 입력하세요"
              ></textarea>
            </div>

            <button id="btn-submit-story" style="margin-top: 10px;">제출</button>

            <!-- 이모티콘 버튼 (사이드바로 이동 - 숨김 처리) -->
            <div class="emoji-section hidden">
              <button id="btn-emoji-toggle" class="emoji-toggle-btn">😊 이모티콘</button>
              <div id="emoji-picker" class="emoji-picker hidden">
                <div id="emoji-list" class="emoji-list"></div>
              </div>
            </div>

            <p id="story-wait-msg" class="hidden">다른 플레이어들을 기다리는 중...</p>
          </div>
        </div>

        <!-- 오른쪽 플레이어 사이드바 -->
        <div id="players-right" class="player-sidebar player-sidebar-right"></div>
      </div>

      <!-- 기존 플레이어 상태 (숨김 처리, JS 호환용) -->
      <div id="player-status-container" class="player-status-container hidden">
        <div id="player-status-list" class="player-status-list"></div>
      </div>

      <!-- 받은 이모티콘 표시 -->
      <div id="emoji-display" class="emoji-display"></div>
    </section>

    <!-- 6. 결과 (채팅방 스타일) -->
    <section id="screen-results" class="screen hidden">
      <div class="results-container">
        <!-- 스토리 제목 -->
        <div id="story-title" class="story-title"></div>

        <!-- 진행 표시 -->
        <div id="story-progress" class="story-progress">
          <span id="progress-text"></span>
        </div>

        <!-- 채팅방 스타일 문장 표시 영역 -->
        <div id="chat-container" class="chat-container"></div>

        <!-- 컨트롤 버튼 -->
        <div class="results-controls">
          <button id="btn-prev" class="control-btn">← 이전 스토리</button>
          <button id="btn-next-story" class="control-btn primary">다음 스토리 →</button>
          <button id="btn-screenshot" class="control-btn primary">📸 저장</button>
        </div>

        <!-- 다시하기 버튼 (마지막에만, 방장만 표시) -->
        <button id="btn-restart" class="hidden">다시하기</button>

        <!-- 결과 화면 이모티콘 반응 버튼 -->
        <div class="result-emoji-section">
          <button id="btn-result-thumbsup" class="result-emoji-btn">👍</button>
          <button id="btn-result-clap" class="result-emoji-btn">👏</button>
        </div>
      </div>

      <!-- 결과 화면 이모티콘 애니메이션 컨테이너 (화면 전체에 표시) -->
      <div id="result-emoji-container" class="result-emoji-container"></div>
    </section>

  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNnt5bLNrHSCJoQzChvDKDzhKKj7KLwR1YYu5/auhyXd0KeN7Xe3RkN9hPpqHNGMaEjRKQO9VFKQFuaZ2yJSzA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="script.js"></script>
</body>
</html>