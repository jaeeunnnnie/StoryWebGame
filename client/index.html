<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>내 친구의 사생활</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- 로고 - 상단 중앙 고정 -->
  <div class="logo-container">
    <img src="./image/00_전체/로고.png" alt="내 친구의 사생활">
  </div>

  <!-- BGM 컨트롤 -->
  <div class="bgm-control">
    <button id="btn-bgm" class="bgm-btn" title="BGM 켜기/끄기">🔊</button>
  </div>

  <!-- BGM 오디오 -->
  <audio id="bgm-audio" loop>
    <source src="./image/00_전체/Multi Game OST.mp3" type="audio/mpeg">
  </audio>

  <div id="app">

    <!-- 1. 입장 화면 (JS: screen-name) -->
    <section id="screen-name" class="screen">
      <div class="entry-container">
        <h1 class="entry-title">내 친구의 사생활</h1>

        <div class="entry-content">
          <!-- 오른쪽: 아바타 선택 -->
          <div class="entry-right" style="order: 2;">
            <div class="avatar-preview-container">
              <div id="avatar-preview" class="avatar-preview"></div>
            </div>
            <div class="avatar-selection">
              <p class="subtitle">아바타 선택</p>
              <div id="avatar-list" class="avatar-list"></div>
            </div>
            <div class="nickname-section">
              <p class="subtitle">닉네임</p>
              <input id="input-nickname" class="nickname-input" placeholder="닉네임 입력" maxlength="10">
            </div>
          </div>

          <!-- 왼쪽: 버튼 -->
          <div class="entry-left" style="order: 1; border-right: none; justify-content: center;">
            <div class="entry-buttons">
              <button id="btn-join-room" class="img-btn">
                <img src="./image/01_메인화면/게임입장하기버튼.png" alt="게임 입장하기">
              </button>
              <button id="btn-create-room" class="img-btn">
                <img src="./image/01_메인화면/게임호스트버튼.png" alt="게임 호스트">
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 2. 방 코드 입력 (JS: screen-waiting) -->
    <section id="screen-waiting" class="screen hidden">
      <div class="card">
        <h2>방 코드 입력</h2>
        <input id="input-room-code" placeholder="예: 12345" />
        <button id="btn-join">Go!</button>
      </div>
    </section>

    <!-- 3. 로비 -->
    <section id="screen-lobby" class="screen hidden">
      <div class="lobby-container">
        <!-- 왼쪽: 버튼들 -->
        <div class="lobby-left">
          <!-- 방 코드 버튼 -->
          <button id="btn-copy" class="room-code-btn">
            <img src="./image/02_로비/방 코드 버튼.png" alt="방 코드" class="room-code-normal">
            <img src="./image/02_로비/방 코드_호버 시_복사하기 버튼.png" alt="코드 복사하기" class="room-code-hover">
            <span id="display-room-code" class="room-code-text"></span>
          </button>

          <!-- 시작하기 버튼 (방장용) -->
          <button id="btn-start" class="lobby-btn hidden">
            <img id="start-btn-img" src="./image/02_로비/시작하기 버튼.png" alt="시작하기">
          </button>

          <!-- 나가기 버튼 -->
          <button id="btn-leave" class="lobby-btn">
            <img src="./image/02_로비/나가기 버튼.png" alt="나가기">
          </button>

          <p id="wait-msg-lobby" class="hidden" style="color: #1e293b;">
            방장이 게임을 시작하기를 기다리는 중…
          </p>
        </div>

        <!-- 오른쪽: 참가자 목록 -->
        <div class="lobby-right">
          <h2 class="lobby-title">참가자 목록</h2>
          <div id="player-list" class="participant-list"></div>
        </div>
      </div>

      <!-- 호스트 컨트롤 (숨김) -->
      <div id="host-controls" class="hidden"></div>
    </section>

    <!-- 4. 카드 입력 (키워드 적기) -->
    <section id="screen-prompts" class="screen hidden">
      <div class="prompt-screen-container">
        <!-- 헤더 -->
        <div class="prompt-header">
          <img src="./image/03_키워드 적기/밑줄_3가지의 키워드 카드를 만들어주세요.png" alt="3가지의 키워드 카드를 만들어주세요">
        </div>

        <!-- 상태 표시 영역 -->
        <div id="prompt-status-container" class="status-container"></div>

        <!-- 카드 입력 영역 -->
        <div class="prompt-container">
          <div class="note-background">
            <div class="keyword-cards-wrapper">
              <div class="keyword-card">
                <img src="./image/03_키워드 적기/카드1.png" alt="카드1">
                <input type="text" class="input-prompt" placeholder="키워드 1">
              </div>
              <div class="keyword-card">
                <img src="./image/03_키워드 적기/카드2.png" alt="카드2">
                <input type="text" class="input-prompt" placeholder="키워드 2">
              </div>
              <div class="keyword-card">
                <img src="./image/03_키워드 적기/카드3.png" alt="카드3">
                <input type="text" class="input-prompt" placeholder="키워드 3">
              </div>
            </div>
          </div>
        </div>

        <!-- 확인 버튼 -->
        <button id="btn-submit-prompts" class="confirm-btn">
          <img id="confirm-btn-img" src="./image/03_키워드 적기/확인.png" alt="확인">
        </button>
        <p id="wait-msg" class="hidden" style="color: #1e293b;">다른 플레이어들을 기다리는 중...</p>
      </div>
    </section>

    <!-- 5. 스토리 이어쓰기 -->
    <section id="screen-story" class="screen hidden">
      <div class="story-layout">
        <!-- 왼쪽 플레이어 사이드바 -->
        <div id="players-left" class="player-sidebar player-sidebar-left"></div>

        <!-- 중앙 게임 영역 -->
        <div class="story-main">
          <div class="story-screen-container">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 0 20px;">
              <h2 style="color: #1e293b; margin: 0;">라운드 <span id="display-round">0</span> / <span id="display-total-rounds">0</span></h2>
              <div id="display-timer" style="font-size: 24px; font-weight: bold; color: #ff6b6b;">20s</div>
            </div>

            <!-- 받은 카드 표시 -->
            <div class="story-cards-display">
              <div id="my-inbox-prompts" class="result-grid"></div>
            </div>

            <!-- 지금까지의 이야기 -->
            <div id="story-so-far" style="background: rgba(255,255,255,0.5); border-radius: 10px; padding: 15px; margin: 10px 20px; max-height: 150px; overflow-y: auto; text-align: left; color: #1e293b;"></div>

            <!-- 입력란 -->
            <div class="story-input-container">
              <div class="story-input-bg">
                <img src="./image/04_스토리 적기/입력란.png" alt="입력란">
                <textarea
                  id="input-story-text"
                  class="story-text"
                  placeholder="여기에 문장을 입력하세요"
                ></textarea>
              </div>
              <button id="btn-submit-story" class="submit-btn">
                <img src="./image/04_스토리 적기/제출.png" alt="제출">
              </button>
            </div>

            <p id="story-wait-msg" class="hidden" style="color: #1e293b;">다른 플레이어들을 기다리는 중...</p>
          </div>
        </div>

        <!-- 오른쪽 플레이어 사이드바 -->
        <div id="players-right" class="player-sidebar player-sidebar-right"></div>
      </div>

      <!-- 이모티콘 버튼 (사이드바로 이동 - 숨김 처리) -->
      <div class="emoji-section hidden">
        <button id="btn-emoji-toggle" class="emoji-toggle-btn">😊 이모티콘</button>
        <div id="emoji-picker" class="emoji-picker hidden">
          <div id="emoji-list" class="emoji-list"></div>
        </div>
      </div>

      <!-- 기존 플레이어 상태 (숨김 처리, JS 호환용) -->
      <div id="player-status-container" class="player-status-container hidden">
        <div id="player-status-list" class="player-status-list"></div>
      </div>

      <!-- 받은 이모티콘 표시 -->
      <div id="emoji-display" class="emoji-display"></div>
    </section>

    <!-- 6. 결과 (엔딩 - 채팅방 스타일) -->
    <section id="screen-results" class="screen hidden">
      <div class="results-screen-container">
        <div class="results-container">
          <!-- 스토리 제목 -->
          <div id="story-title" class="story-title"></div>

          <!-- 진행 표시 -->
          <div id="story-progress" class="story-progress">
            <span id="progress-text"></span>
          </div>

          <!-- 채팅방 스타일 문장 표시 영역 -->
          <div id="chat-container" class="chat-container"></div>

          <!-- 엔딩 컨트롤 버튼 -->
          <div class="ending-controls">
            <button id="btn-prev" class="ending-btn">
              <img src="./image/05_엔딩/이전 이야기로.png" alt="이전 이야기로">
            </button>
            <button id="btn-next-story" class="ending-btn">
              <img src="./image/05_엔딩/다음 이야기로.png" alt="다음 이야기로">
            </button>
            <button id="btn-screenshot" class="ending-btn">
              <img src="./image/05_엔딩/저장하기.png" alt="저장하기">
            </button>
          </div>

          <!-- 다시하기 버튼 (마지막에만, 방장만 표시) -->
          <button id="btn-restart" class="ending-btn hidden">
            <img src="./image/05_엔딩/다시하기.png" alt="다시하기">
          </button>

          <!-- 결과 화면 이모티콘 반응 버튼 -->
          <div class="result-emoji-section">
            <button id="btn-result-thumbsup" class="result-emoji-btn">👍</button>
            <button id="btn-result-clap" class="result-emoji-btn">👏</button>
          </div>
        </div>
      </div>

      <!-- 결과 화면 이모티콘 애니메이션 컨테이너 (화면 전체에 표시) -->
      <div id="result-emoji-container" class="result-emoji-container"></div>
    </section>

  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNnt5bLNrHSCJoQzChvDKDzhKKj7KLwR1YYu5/auhyXd0KeN7Xe3RkN9hPpqHNGMaEjRKQO9VFKQFuaZ2yJSzA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="script.js"></script>
</body>
</html>
